<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì‚¬ì› ëª©ë¡</title>
</head>
<body>
    <h2>ğŸ“‹ ì‚¬ì› ëª©ë¡</h2>

  
    <form method="get" action="{% url 'employee_list' %}" style="margin-bottom: 20px;">
        <!-- ì´ë¦„/ì‚¬ë²ˆ ê²€ìƒ‰ -->
        <input type="text" name="search" placeholder="ì´ë¦„ ë˜ëŠ” ì‚¬ë²ˆ ê²€ìƒ‰" value="{{ request.GET.search }}">
        
        <!-- ë¶€ì„œ ì„ íƒ -->
        <select name="department">
            <option value="">-- ë¶€ì„œ ì„ íƒ --</option>
            {% for dept in department_list %}
                <option value="{{ dept }}" {% if department_query == dept %}selected{% endif %}>
                    {{ dept }}
                </option>
            {% endfor %}
        </select>
    
        <!-- ì…ì‚¬ì¼/í‡´ì‚¬ì¼/ê¸°ì¤€ì¼ ì„ íƒ -->
        ì…ì‚¬ì¼:
        <input type="date" name="hire_date_from" value="{{ hire_date_from }}">
        ~
        <input type="date" name="hire_date_to" value="{{ hire_date_to }}">
    
        í‡´ì‚¬ì¼:
        <input type="date" name="resign_date_from" value="{{ resign_date_from }}">
        ~
        <input type="date" name="resign_date_to" value="{{ resign_date_to }}">
    
        ê¸°ì¤€ì¼:
        <input type="date" name="reference_date" value="{{ request.GET.reference_date }}">
    
        <!-- âœ… ê²€ìƒ‰ ë²„íŠ¼ì€ ì—¬ê¸°! -->
        <button type="submit">ê²€ìƒ‰</button>
    </form>
    
    <br>
    <a href="{% url 'home' %}">â† ë©”ì¸ìœ¼ë¡œ</a>

    <!-- âœ… í•„í„° ì´ˆê¸°í™” ë²„íŠ¼ -->
    <a href="{% url 'employee_list' %}" style="margin-left: 10px;">
        <button type="button">ğŸ”„ ì´ˆê¸°í™”</button>
    </a>

    <a href="{% url 'export_employees_excel' %}?{{ request.GET.urlencode }}">
        <button type="button">ğŸ“¥ í•„í„° ì ìš©ëœ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</button>
    </a>


    <div style="margin-bottom: 15px;">
        <a href="{% url 'employee_list' %}" style="margin-right:10px;">ì „ì²´ ë³´ê¸°</a>
        <a href="{% url 'employee_list' %}?filter=active" style="margin-right:10px;">ì¬ì§ìë§Œ ë³´ê¸°</a>
        <a href="{% url 'employee_list' %}?filter=retired">í‡´ì§ìë§Œ ë³´ê¸°</a>
    </div>
    
    <table border="1" cellpadding="5">
        <thead>
            <tr>
                <th>ì‚¬ë²ˆ</th>
                <th>ì´ë¦„</th>
                <th>ì„±ë³„</th>
                <th>ë‚˜ì´</th>
                <th>ê³ ìš©í˜•íƒœ</th>
                <th>ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸</th>
                <th>ì—°ë½ì²˜</th>
                <th>ë¶€ì„œ</th>
                <th>ì§ì±…</th>
                <th>ì§ê¸‰</th>
                <th>ë…„ì°¨</th>
                <th>ì§ë¬´</th>
                <th>ì…ì‚¬ì¼</th>   <!-- ì¶”ê°€ -->
                <th>í‡´ì‚¬ì¼</th>   <!-- ì¶”ê°€ -->
                <th>ìƒíƒœ</th>
                <th>ì´ë©”ì¼</th>
                <th>ì£¼ì†Œ</th>  <!-- âœ… ì¶”ê°€ -->
                <th>ì‚­ì œ</th>
            </tr>
        </thead>
        <tbody>
            {% for employee in employees %}
            <tr>
                <td>{{ employee.employee_id }}</td>
                <td>{{ employee.name }}</td>
                <td>{{ employee.gender }}</td>
                + <td>{{ employee.age }}</td>
                <td>{{ employee.employment_type }}</td>
                <td>{{ employee.ssn }}</td>
                <td>{{ employee.phone }}</td>
                <td>{{ employee.department }}</td>
                <td>{{ employee.position_title }}</td>
                <td>{{ employee.position }}</td>
                <td>{{ employee.years_worked }}</td>
                <td>{{ employee.role }}</td>
                <td>{{ employee.hire_date|date:"Y-m-d" }}</td> <!-- ìˆ˜ì • -->
                <td>
                    {% if employee.resign_date %}
                        {{ employee.resign_date|date:"Y-m-d" }}
                    {% else %}
                        -
                    {% endif %}
                </td>
                <td>
                    {% if employee.status == 'íœ´ì§' %}
                    <span style="color: orange;">íœ´ì§</span><br>
                    <small>
                        {{ employee.leave_type }}
                        {% if employee.leave_start_date and employee.leave_end_date %}
                            ({{ employee.leave_start_date|date:"Y-m-d" }} ~ {{ employee.leave_end_date|date:"Y-m-d" }})
                        {% else %}
                            (íœ´ì§ê¸°ê°„ ë¯¸ì…ë ¥)
                        {% endif %}
                    </small>
                
                    {% elif employee.status == 'í‡´ì§' %}
                        <span style="color: gray;">í‡´ì§</span>
                    {% else %}
                        <span style="color: green;">ì¬ì§</span>
                    {% endif %}
                </td>
                <td>{{ employee.email }}</td>
                <td>{{ employee.address }}</td>
                <td>
                    <form action="{% url 'delete_employee' employee.pk %}" method="post" style="display:inline;">
                        {% csrf_token %}
                        <button type="submit" onclick="return confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">ì‚­ì œ</button>
                    </form>
                </td>
            </tr>
            {% empty %}
            <tr><td colspan="8">ë“±ë¡ëœ ì‚¬ì›ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr> <!-- ìˆ˜ì •: 8ì¹¸ -->
            {% endfor %}
        </tbody>
    </table>

</body>
</html>